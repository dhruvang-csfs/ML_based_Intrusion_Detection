# ML_based_Intrusion_Detection
# üõ°Ô∏è Advanced Network Intrusion Detection System (NIDS)

An optimized machine learning approach for detecting malicious network traffic using the **UNSW-NB15 dataset**. This project explores and compares the performance of various classification algorithms, including a highly-tuned **Artificial Neural Network (ANN)**, to identify network attacks with high accuracy and recall.

---

## üöÄ Project Introduction

Modern cybersecurity relies heavily on effective Intrusion Detection Systems (IDS) to monitor network traffic and flag suspicious activities. This repository implements a sophisticated **Host-based/Network-based Intrusion Detection System (NIDS)** leveraging several machine learning models.

The primary goal is to **classify network flow records as either 'Normal' or 'Attack'** by:
1.  **Robust Data Preprocessing:** Handling categorical features and missing values.
2.  **Feature Engineering & Selection:** Using **StandardScaler** and **SelectKBest (f_classif)** to reduce dimensionality and focus on the most relevant features.
3.  **Comparative Analysis:** Training and evaluating **five distinct ML/DL models** (ANN, Logistic Regression, Decision Tree, Random Forest, and LinearSVC) to determine the best performer.

---

## üíª Project Overview

The core script performs the following steps:

1.  **Data Loading:** Reads the `UNSW_NB15` training and testing datasets (expected as `.parquet` files).
2.  **Preprocessing:** Applies **Label Encoding** to categorical columns, handles `NaN` values, and converts all features to numeric types.
3.  **Scaling & Selection:** The data is **Standard Scaled** and features are reduced from **45 to 40** using $K$-Best selection to optimize training speed and generalization.
4.  **Model Training:**
    * **ANN (Optimized):** A multi-layer deep learning model with **Dropout** and **EarlyStopping** for robust training.
    * **Random Forest (Optimized):** Tuned with a high number of estimators for better prediction.
    * **Logistic Regression** and **Decision Tree** for baseline comparison.
    * **LinearSVC:** Used with `CalibratedClassifierCV` for efficiency and probability scores on the large dataset.
5.  **Evaluation:** Models are evaluated using **Accuracy, Recall, Precision, and ROC AUC**.
6.  **Visualization & Persistence:** Results are displayed in a comparison table and visualized using **Bar Plots** and **ROC Curves**. The preprocessing pipeline (`scaler`, `selector`) and the **best-performing model** are saved to disk (`.pkl`).

---

## üìÇ Dataset Information

### üåê UNSW-NB15 Dataset

This project utilizes the well-known **UNSW-NB15** dataset, a standard benchmark for network intrusion detection research.

* **Source:** Generated by the Australian Centre for Cyber Security (ACCS) using the IXIA PerfectStorm tool.
* **Content:** Contains nine types of attacks: Fuzzers, Analysis, Backdoors, DoS, Exploits, Generic, Reconnaissance, Shellcode, and Worms, alongside normal traffic.
* **Format Used:** The script expects the training and testing sets to be in the **Parquet** format for efficient loading and storage:
    * `UNSW_NB15_training-set.parquet`
    * `UNSW_NB15_testing-set.parquet`
* **Target Column:** The `label` column (1 for Attack, 0 for Normal) is used as the classification target.

üöÄ How to Run the Project
‚úîÔ∏è Prerequisites
Ensure you have Python 3.8+ installed. Install all necessary dependencies, including TensorFlow/Keras and PyArrow (required for reading Parquet files):

pip install pandas numpy scikit-learn matplotlib seaborn tensorflow joblib pyarrow

‚ñ∂Ô∏è Execution Steps

1Ô∏è‚É£ Place the Dataset
The script requires the UNSW-NB15 training and testing files in the efficient Parquet format. Place the following files in the root directory of the project:

UNSW_NB15_training-set.parquet

UNSW_NB15_testing-set.parquet

2Ô∏è‚É£ Train the Models
Run the main script to perform preprocessing, train the five machine learning and deep learning models, evaluate them, and save the results.

This script performs the following:

Loads and preprocesses the data (Scaling, Label Encoding).

Trains the ANN, Random Forest, LinearSVC, Logistic Regression, and Decision Tree models.

Outputs detailed evaluation metrics and performance plots.

Saves the preprocessing pipeline to: nids_preprocessing_pipeline_optimized.pkl

Saves the best-performing model to either:

nids_best_model_ann_optimized.h5 (if ANN is best)

nids_best_model_<Model_Name>.pkl (for other models)

üì¶ Prebuilt Files
If you wish to skip the training process and use a pre-trained system:

‚¨áÔ∏è Download the preprocessing pipeline (nids_preprocessing_pipeline_optimized.pkl).

‚¨áÔ∏è Download the desired pre-trained model file (.pkl or .h5).

Place these files inside your project folder to use the system for deployment or testing.

üìú License
This project is free to use for research, educational, and non-commercial purposes.
